# Indexing collections of signatures with MinHash Bloom Trees and LCADB

\chaptermark {MHBT}

## Introduction

### Hierarchical index

Searching for matches in large collection of datasets is not viable when hundreds of thousands of
them are available, 
especially if they are partitioned and not all present at the same place.

Bloofi [@crainiceanu_bloofi:_2015] is a hierarchical index structure that
extends the Bloom Filter basic query to collections of Bloom Filters.
Instead of calculating the union of all Bloom Filters in the collection
(which would allow answering if an element is present in any of them)
it defines a tree structure where the original Bloom Filters are leaves,
and internal nodes are the union of all the Bloom Filters in their subtrees.
Searching is based on a breadth-first search,
with pruning when no matches are found at an internal level.
Bloofi can also be partitioned in a network,
with network nodes containing a subtree of the original tree and only being
accessed if the search requires it.

The Sequence Bloom Tree [@solomon_fast_2016] adapts Bloofi for genomic contexts,
rephrasing the problem as experiment discovery:
given a query sequence $Q$ and a threshold $\theta$,
which experiments contain at least $\theta$ of the original query $Q$?
Experiments are encoded in Bloom Filters containing the $k$-mer composition of transcriptomes,
and queries are transcripts.

Further developments focused on clustering similar datasets to prune search
early [@sun_allsome_2017] and developing more efficient representations for the
internal nodes [@solomon_improved_2017] [@harris_improved_2018] to use less
storage space and memory.

## Methods

## Results

### sourmash is not a taxonomic profiler...

### ... until it is.

<!-- 
compare with CAMI 2 mouse gut toy challenge set, because it has a gold standard

if comparing with CAMI 1, use CAMI_1_HIGH, since it doesn't have viruses.
CAMI 2 refseq database also doesn't have viruses...
TODO: I have the data for building signatures for genbank viruses, 
-->

## Discussion

## Conclusion
